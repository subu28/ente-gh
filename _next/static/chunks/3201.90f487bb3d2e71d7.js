!function(){var e,t,r,n,o,i,a={21491:function(e,t,r){"use strict";r(96045),r(18762)},87299:function(e,t,r){"use strict";r(96045),r(79541),r(21491),r(58178),r(42917),r(30290),r(47371),r(88619),r(57532),r(88659),r(18786),r(73873),r(95525),r(89610),r(94522),r(5155),r(82797),r(55071)},79541:function(e,t,r){"use strict";r.d(t,{$9:function(){return v},DJ:function(){return S},Qq:function(){return N},SA:function(){return y},c2:function(){return T}});var n,o,i=r(58178),a=r(38229);r(42917);var c=r(54032),s=r(96045),u=r(5083),l=r(30290);r(88659),r(10005),r(24991);var d=r(72751),f=r.n(d);r(5155);var E=r(55151);r(47371);var p=r(33009);r(82797);var _=r(77060);r(40795),r(71583),r(63490);let O=["heic","rw2","tiff","arw","cr3","cr2","nef","psd","dng","tif"];(n=o||(o={}))[n.DOWNLOAD=0]="DOWNLOAD",n[n.FIX_TIME=1]="FIX_TIME",n[n.ARCHIVE=2]="ARCHIVE",n[n.UNARCHIVE=3]="UNARCHIVE",n[n.HIDE=4]="HIDE",n[n.TRASH=5]="TRASH",n[n.DELETE_PERMANENTLY=6]="DELETE_PERMANENTLY";class I{constructor(){this.isNativeJPEGConversionNotAvailable=!1}}let D=new I;async function T(e,t,r){var n;let o=(0,c.qN)(t.metadata.title);if(t.metadata.fileType!==i.Gk.IMAGE||null===(n=t.pubMagicMetadata)||void 0===n||!n.data.editedTime||"jpeg"!=o&&"jpg"!=o)return r;{let n=await new Response(r).blob();return(await (0,p.Qh)(e,n,new Date(t.pubMagicMetadata.data.editedTime/1e3))).stream()}}let N=async(e,t)=>{try{let r=new File([t],e),n=await (0,E.S)(r);s.ZP.debug(()=>"Need renderable image for ".concat(JSON.stringify({fileName:e,...n})));let{extension:o}=n;if(!(0,a.y)(o)){let r=n.mimeType;if(!r)return s.ZP.info("Trying to render a file without a MIME type",e),t;return new Blob([t],{type:r})}let i=!D.isNativeJPEGConversionNotAvailable;if(f()()&&i&&O.includes(o.toLowerCase()))try{return await g(t)}catch(e){e.message.endsWith(u.S.NotAvailable)?D.isNativeJPEGConversionNotAvailable=!0:s.ZP.error("Native conversion to JPEG failed",e)}if("heic"==o||"heif"==o)return await (0,_.x)(t);return}catch(t){s.ZP.error("Failed to get renderable image for ".concat(e),t);return}},g=async e=>{let t=Date.now(),r=new Uint8Array(await e.arrayBuffer()),n=globalThis.electron,o=n?await n.convertToJPEG(r):await l.j.convertToJPEG(r);return s.ZP.debug(()=>"Native JPEG conversion took ".concat(Date.now()-t," ms")),new Blob([o],{type:"image/jpeg"})};function y(e){return e.map(e=>{var t,r;return(null===(t=e.pubMagicMetadata)||void 0===t?void 0:t.data.editedTime)&&(e.metadata.creationTime=e.pubMagicMetadata.data.editedTime),(null===(r=e.pubMagicMetadata)||void 0===r?void 0:r.data.editedName)&&(e.metadata.title=e.pubMagicMetadata.data.editedName),e})}function v(e,t,r){if(!(null==t?void 0:t.id))throw Error("user missing");return e.filter(e=>e.ownerID===t.id&&(!r||r.get(e.collectionID)===t.id))}function S(e){return e.sort((e,t)=>e.id-t.id)}},57532:function(e,t,r){"use strict";r.d(t,{Pr:function(){return a}});var n=r(72751),o=r.n(n);let i=new Map,a=async e=>{let t=i.get(e);return t||i.set(e,t=await c(e)),t},c=async e=>o()()?u(e):s(e),s=async e=>{let t=await caches.open(e);return{get:async e=>{let r=await t.match(e);return await (null==r?void 0:r.blob())},put:(e,r)=>t.put(e,new Response(r)),delete:e=>t.delete(e)}},u=async e=>{let t=await navigator.storage.getDirectory(),r=await t.getDirectoryHandle("cache",{create:!0}),n=await r.getDirectoryHandle(e,{create:!0});return{get:async e=>{try{let t=await n.getFileHandle(e);return await t.getFile()}catch(e){if(e instanceof DOMException&&"NotFoundError"==e.name)return;throw e}},put:async(e,t)=>{let r=await n.getFileHandle(e,{create:!0}),o=await r.createWritable();await o.write(t),await o.close()},delete:async e=>{try{return await n.removeEntry(e),!0}catch(e){if(e instanceof DOMException&&"NotFoundError"==e.name)return!1;throw e}}}}},92396:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var n=r(30195);let o=n.z.object({id:n.z.number(),email:n.z.string(),token:n.z.string()}),i=()=>{let e=localStorage.getItem("user");if(e)return o.parse(JSON.parse(e))},a=()=>{let e=i();if(!e)throw Error("Not logged in");return e}},30290:function(e,t,r){"use strict";r.d(t,{j:function(){return n}});let n=(0,r(90758).Ud)(globalThis)},18786:function(e,t,r){"use strict";r.d(t,{MS:function(){return n},Rp:function(){return o},sH:function(){return i}});class n extends Error{constructor(e,t,r){super(e),this.name="ApiError",this.errCode=t,this.httpStatusCode=r}}function o(e){return e&&"code"in e&&"message"in e}let i={VIDEO_PLAYBACK_FAILED:"video playback failed",ETAG_MISSING:"no header/etag present in response body",KEY_MISSING:"encrypted key missing from localStorage",FAILED_TO_LOAD_WEB_WORKER:"failed to load web worker",UNSUPPORTED_FILE_FORMAT:"unsupported file format",FILE_TOO_LARGE:"file too large",SUBSCRIPTION_EXPIRED:"subscription expired",STORAGE_QUOTA_EXCEEDED:"storage quota exceeded",SESSION_EXPIRED:"session expired",INVALID_MIME_TYPE:e=>"invalid mime type -".concat(e),SIGNUP_FAILED:"signup failed",FAV_COLLECTION_MISSING:"favorite collection missing",INVALID_COLLECTION_OPERATION:"invalid collection operation",TO_MOVE_FILES_FROM_MULTIPLE_COLLECTIONS:"to move files from multiple collections",REQUEST_CANCELLED:"request canceled",REQUEST_FAILED:"request failed",TOKEN_EXPIRED:"token expired",TOKEN_MISSING:"token missing",TOO_MANY_REQUESTS:"too many requests",BAD_REQUEST:"bad request",SUBSCRIPTION_NEEDED:"subscription not present",NOT_FOUND:"not found ",NO_METADATA:"no metadata",FILE_ID_NOT_FOUND:"file with id not found",WEAK_DEVICE:"password decryption failed on the device",INCORRECT_PASSWORD:"incorrect password",UPLOAD_CANCELLED:"upload cancelled",REQUEST_TIMEOUT:"request taking too long",HIDDEN_COLLECTION_SYNC_FILE_ATTEMPTED:"hidden collection sync file attempted",UNKNOWN_ERROR:"Something went wrong, please try again",WINDOWS_NATIVE_IMAGE_PROCESSING_NOT_SUPPORTED:"Windows native image processing is not supported",NETWORK_ERROR:"Network Error",NOT_FILE_OWNER:"not file owner",UPDATE_EXPORTED_RECORD_FAILED:"update file exported record failed",EXPORT_STOPPED:"export stopped",NO_EXPORT_FOLDER_SELECTED:"no export folder selected",EXPORT_FOLDER_DOES_NOT_EXIST:"export folder does not exist",AUTH_KEY_NOT_FOUND:"auth key not found",EXIF_DATA_NOT_FOUND:"exif data not found",SELECT_FOLDER_ABORTED:"select folder aborted",PROCESSING_FAILED:"processing failed",EXPORT_RECORD_JSON_PARSING_FAILED:"export record json parsing failed",TWO_FACTOR_ENABLED:"two factor enabled",PASSKEYS_TWO_FACTOR_ENABLED:"passkeys two factor enabled",CLIENT_ERROR:"client error",ServerError:"server error",FILE_NOT_FOUND:"file not found",UNSUPPORTED_PLATFORM:"Unsupported platform",UPDATE_URL_FILE_ID_MISMATCH:"update url file id mismatch",URL_ALREADY_SET:"url already set",FILE_CONVERSION_FAILED:"file conversion failed"}},94522:function(e,t,r){"use strict";r(10005)},88619:function(e,t,r){"use strict";r(9174)},18762:function(e,t,r){"use strict";var n,o;let i,a;let c=(e,t)=>t.some(t=>e instanceof t),s=new WeakMap,u=new WeakMap,l=new WeakMap,d={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return function e(t){var r;if(t instanceof IDBRequest)return function(t){let r=new Promise((r,n)=>{let o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(e(t.result)),o()},a=()=>{n(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return l.set(r,t),r}(t);if(u.has(t))return u.get(t);let n="function"==typeof(r=t)?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(r)?function(...t){return r.apply(f(this),t),e(this.request)}:function(...t){return e(r.apply(f(this),t))}:(r instanceof IDBTransaction&&function(e){if(s.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)});s.set(e,t)}(r),c(r,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(r,d):r;return n!==t&&(u.set(t,n),l.set(n,t)),n}(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e},f=e=>l.get(e),E=["get","getKey","getAll","getAllKeys","count"],p=["put","add","delete","clear"],_=new Map;function O(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(_.get(t))return _.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,o=p.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||E.includes(r)))return;let i=async function(e,...t){let i=this.transaction(e,o?"readwrite":"readonly"),a=i.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),o&&i.done]))[0]};return _.set(t,i),i}d={...n=d,get:(e,t,r)=>O(e,t)||n.get(e,t,r),has:(e,t)=>!!O(e,t)||n.has(e,t)};let I=["continue","continuePrimaryKey","advance"],D={},T=new WeakMap,N=new WeakMap,g={get(e,t){if(!I.includes(t))return e[t];let r=D[t];return r||(r=D[t]=function(...e){T.set(this,N.get(this)[t](...e))}),r}};async function*y(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let r=new Proxy(t,g);for(N.set(r,t),l.set(r,f(t));t;)yield r,t=await (T.get(r)||t.continue()),T.delete(r)}function v(e,t){return t===Symbol.asyncIterator&&c(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&c(e,[IDBIndex,IDBObjectStore])}d={...o=d,get:(e,t,r)=>v(e,t)?y:o.get(e,t,r),has:(e,t)=>v(e,t)||o.has(e,t)}}},c={};function s(e){var t=c[e];if(void 0!==t)return t.exports;var r=c[e]={exports:{}},n=!0;try{a[e](r,r.exports,s),n=!1}finally{n&&delete c[e]}return r.exports}s.m=a,s.x=function(){var e=s.O(void 0,[1314,1239,8055],function(){return s(87299)});return s.O(e)},e=[],s.O=function(t,r,n,o){if(r){o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[r,n,o];return}for(var a=1/0,i=0;i<e.length;i++){for(var r=e[i][0],n=e[i][1],o=e[i][2],c=!0,u=0;u<r.length;u++)a>=o&&Object.keys(s.O).every(function(e){return s.O[e](r[u])})?r.splice(u--,1):(c=!1,o<a&&(a=o));if(c){e.splice(i--,1);var l=n();void 0!==l&&(t=l)}}return t},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce(function(t,r){return s.f[r](e,t),t},[]))},s.u=function(e){return"static/chunks/"+e+"."+({1239:"395088019dbe851e",1314:"2b00ee3e31acbe09",2942:"05136459d3abfbbf",6167:"58eb58bf88c76ab1",7644:"0e3a06ff10fd26df",8055:"980c7b8be20ca7ad"})[e]+".js"},s.miniCssF=function(e){},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.tt=function(){return void 0===t&&(t={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t},s.tu=function(e){return s.tt().createScriptURL(e)},s.p="/_next/",s.b=self.location+"/../../../",r={3201:1},s.f.i=function(e,t){r[e]||importScripts(s.tu(s.p+s.u(e)))},o=(n=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(n),n.push=function(e){var t=e[0],n=e[1],i=e[2];for(var a in n)s.o(n,a)&&(s.m[a]=n[a]);for(i&&i(s);t.length;)r[t.pop()]=1;o(e)},i=s.x,s.x=function(){return Promise.all([1314,1239,8055].map(s.e,s)).then(i)},_N_E=s.x()}();